setwd("/Users/gregfaletto/Documents/R/Econometrics/test1")
data <- read.table("TestExer1-holiday expenditures-round2.txt", header=T)
str(data)
rm(list=ls())
library("ggplot2")
data <- read.table("TestExer1-holiday expenditures-round2.txt", header=T)
n <- nrow(data)
A.bar <- mean(data$Age)
E.bar <- mean(data$Expenditures)
b <- (data$Age-A.bar)%*%(data$Expenditures-E.bar)/((data$Age-
A.bar)%*%(data$Age-A.bar))
a <- E.bar-b*A.bar
print("Regression line:")
print(paste("b=", b))
print(paste("a=", a.women))
print(paste("a=", a))
model <- lm(Expenditures ~ Age, data=data)
print(paste("According to the built-in linear regression function lm(), a =",
as.numeric(model$coefficients[1]), "and b =",
as.numeric(model$coefficients[2]), "."))
print(paste("In a, difference of",
a-as.numeric(model$coefficients[1])))
print(paste("In b, difference of",
b-as.numeric(model$coefficients[2])))
predictions <- a + b*data$Age
predictions
s.squared <- (1/(n-2))*(data$Expenditures-predictions)%*%
(data$Expenditures-predictions)
s.squared
predictions <- a + b*data$Age
s.squared <- (1/(n-2))*(data$Expenditures-predictions)%*%
(data$Expenditures-predictions)
se.b <- s.squared/((data$Age-A.bar)%*%(data$Age-A.bar))
print(paste("Standard error of b:", se.b))
t.b <- b/se.b
print(paste("t-value of b:", t.b))
df <- data.frame(data)
plot <- ggplot(data=df, aes(x=Age, y=Expenditures)) +
geom_point() + stat_function(fun=function(x)(a+b*x),
geom="line")
print(plot)
model <- lm(Expenditures ~ Age, data=data)
model
summary(model)
ses.b
se.b
s.squared
(data$Expenditures-predictions)%*%
(data$Expenditures-predictions)/(n-2)
(data$Expenditures-predictions)
50.73^2
5.073^2
s.squared
n
se.b <- sqrt(s.squared/((data$Age-A.bar)%*%(data$Age-A.bar)))
se.b
t.b <- b/se.b
t.b
source(file="testex1.R")
source(file="testex1.R")
source(file="testex1.R")
source(file="testex1.R")
source(file="testex1.R")
source(file="testex1.R")
summary(model.over)
summary(model.under)
source(file="testex1.R")
source(file="testex1.R")
